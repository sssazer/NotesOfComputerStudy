# Lambda表达式

5.4版本即之前需要提前说明要使用Lambda表达式

在.pro文件中添加 `CONFIG += C++11`

Lambda表达式起始是一个匿名函数，在调用或者作为函数参数传递的位置处定义，可以简化代码

基本语法：`[捕获列表](参数列表)mutable -> 返回值类型{函数体}`

- [ \] , 中括号标识一个Lambda的开始，**不能省略**。 里面的捕获列表用来捕捉上下文中的变量以供Lambda函数使用

    建议使用值传递的方式捕获
  - [空白]：表示不捕获任何变量
  - [var]：以值传递的方式捕获变量var

    ```C++
    int num = 100;
    [num]{
        cout << num << endl;
    }();
    ```
    最后那个括号表示直接调用这个匿名的Lambda表达式

  - [=]：以值传递的方式捕获所有父作用域的变量(包括this)

    就是捕获它所在的函数的所有局部变量

    ```C++
    int index = 1;
    int num = 100;
    [=]{
        cout << index << num << endl;
    }();
    ```

  - [&var]：以引用的方式捕获变量var
  - [&]：以引用的方式捕获所有父作用域的变量
  - [this]：以值传递的方式捕获当前的this指针
  - [=,&var1,&var2] : 以引用传递的方式捕获变量var1和var2，以值传递的方式捕获其它所有变量
  - [&,var1,var2] : 以值传递的方式捕获变量var1和var2，以引用传递的方式捕获其它所有变量
  
  捕捉列表不允许重复捕捉：

  - [=,var1]：已经用值传递的方式捕捉了所有变量，又用值传递的方式重复捕捉了var1，报错。
  - [&,&var1]：已经用引用传递的方式捕捉了所有变量，又用引用传递的方式重复捕捉了var1，报错。

- (参数列表) ： 没有参数可以省略 

    ```C++
    [](int a, int b){
        cout << a+b << endl;
    }(100,200);
    ```

- mutable关键字：不需要可以省略

    按值传递的方式捕捉变量时，默认情况下是加const关键字修饰的

    加上mutable关键字可以修改按值传递捕捉的变量的拷贝(只能修改拷贝不能修改本体)

- -> : 后面加Lambda的返回值类型，可以省略

    因为Lambda的返回值类型会自动推导，一般用不到

    ```C++
    int a = []->int{
        return 1000;
    }();
    ```

- {} ： 函数体，可以是空但是不能省略

## 使用模板：
为按钮绑定功能
```C++

connect(btn, &QPushButton::clicked, this, [=]{ // this可省略
    this->close();
    其它想调用的函数...
});
```