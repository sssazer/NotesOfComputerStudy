# 1. Unity面板

## 1.1 Project项目资源面板

用于存放游戏的所有资源，比如场景、模型、图片、音频等资源

与项目中资源文件夹Assets对应

Assets文件夹中，每个文件或文件夹都会有对应的.meta文件，这是unity用于记录资源信息的文件

## 1.2 Hierarchy层次面板

显示当前场景中所有游戏对象，将项目资源拖入场景中就会自动创建游戏对象

## 1.3 Scene场景面板

提供设计游戏界面的可视化面板

**常用操作：**

- 滑动滚轮缩放场景，按下滚轮拖动场景
- 鼠标右键旋转视角
- 按下鼠标右键同时按下W/A/S/D/Q/E可以实现在场景中移动
- 在Scene面板选中物体按下F键，或者在Hierarchy面板双击对象可以将物体设置为场景试图的中心
- 按住ALT键时，可以通过鼠标左键旋转场景，通过鼠标右键缩放场景
- 选中物体后按Ctrl+D可以复制一份

## 1.4 Game游戏面板

预览游戏运行后的画面

## 1.5 Inspector检视面板

显示当前选定游戏对象 附加的组件及其属性信息

### 1.5.1 Transform属性

可以在该属性下调整物体坐标(Position)、旋转角度(Rotation)、大小(Scale)

# 2. Unity工具

在菜单栏下方，下面从左到右依次介绍

## 2.1 变换工具

在左上角有一排，分别表示

- Q：移动场景
- W：移动物体
- E：旋转物体
- R：缩放物体

## 2.2 变换切换

**左边是改变游戏对象的轴心点**

- Center：设置轴心点在物体几何中心
- Pivot：使用物体本身(建模时)的轴心点

Pivot是在unity中是不能改变的，只能在建模软件中改变

如果选中多个物体，那么Center是将多个物体视为整体，然后计算几何中心

**右边是改变物体的坐标系**

- Global：使用世界坐标系，以世界中心为轴

  六个方向代表世界的上下东西南北

- Local：使用自身坐标系，以自己轴心点为轴

  六个方向代表自己的上下前后左右

## 2.3 播放控件

从左至右依次是：预览游戏、暂停游戏、逐帧播放

在播放模式（运行状态）下也可以调整物体，添加物体，但是都是临时的，不能直接保存。退出播放模式后所有改动都会消失

可以在Inspector面板 - 对应属性 - 最右侧三个点 - CopyComponent保存当前属性。退出播放模式之后，在同样位置点击Pastes Component Values复制参数

## 2.4 视图

Scene界面右上角的坐标轴，只是决定在Scene面板中的显示效果

有两个视图，可以按坐标轴中间的方块切换

- ISO：正交观察模式（2D）
- Persp：透视观察模式（3D）、

# 3. 基础概念

## 3.1 坐标

坐标轴：

- X轴（红色，right）：沿x轴移动表示左右移动
- Y轴（绿色，up）：沿y轴移动表示上下移动
- z轴（蓝色，forward）：沿z轴移动表示前后移动

一般物体的正脸与z轴正向一致

坐标分类：

- 世界坐标Global Position：物体在整个世界中的绝对坐标
- 本地坐标Local Position：物体相对于父物体的相对坐标，Transform组件中显示的Position就是local position

## 3.2 场景Scene

一组相关联的游戏对象（Hierarchy面板中）的集合，通常每个关卡就是一个场景，用于展现当前关卡中的所有物体

- Ctrl+s保存当前场景，保存为.unity文件
- Ctrl+n新建新场景

## 3.3 游戏对象GameObject

运行时出现在场景中的游戏物体

游戏对象就是一种容器，用于挂载组件(Inspector面板中可以查看)

**父子物体：**

一个物体拖拽到另一个物体中就变成子物体，此时子物体的Transform属性就不是全局的，而是相对于父物体的

一般用空物体作为父物体进行打组

## 3.4 组件Component

是游戏对象的功能模块，每个组件都是一个类的实例

### 3.4.1 必备组件：

**Transform变换组件：**

决定物体位置、旋转、缩放比

是所有物体必备组件

**Mesh Filter网格过滤器：**

决定资源的网格信息，也就是物体的几何形状。每个形状都是由网格组成的

网格(Mesh)中包含了面、顶点坐标、面的法向等数据

在Scene面板左上角可以更改显示模式

- Shaded：着色模式，显示表面材质
- Wireframe：线框模式，仅显示网格
- Shaded+Wireframe：线框着色模式

**Mesh Renderer网格渲染器：**

根据网格过滤器的几何形状将物体渲染成3D模型

网格过滤器和网格渲染器联合使用，使模型显示到屏幕上

**示例：**用组件创建一个立方体

1. 创建空物体GameObject：在Hierarchy中右键，选择Create Empty

2. 选中物体，在Inspector界面中Add Component - Mesh - Mesh Filter

   其中会包含一个Mesh属性，初始为None，点击右侧小圆点修改为Cube

3. 再Add Component - Mesh - Mesh Renderer

   可以在其中修改渲染时使用的材质

### 3.4.2 Material材质

材质可以决定物体的质地（色彩、纹理等），实际上是Shader的实例。Shader(着色器)是专门用来渲染3D图形的一段程序。

`Shader --实例为---> 材质 --作用于--> 物体`

在Mesh Renderer中设置物体材质 ，默认的Default Material不能修改，需要在Project面板中新建材质

**属性：**

- Rendering Mode：渲染模式

  - Opaque：不透明，默认选项
  - Transparent：透明，设置为这个模式后还需要在颜色中设置物体的透明度
  - Fade：渐变，可以完全透明
  - Cutout：镂空，可以去掉贴图中的透明通道

- Albedo：基础贴图

  在左侧可以导入图片，右侧设置颜色

网格+材质+贴图，应该在建模软件中完成，然后导出为FBX格式导入unity中

### 3.4.3 Camera摄像机

附加了摄像机组件的游戏对象都是摄像机，场景中摄像机的数量不受限制，但是Audio Listener只能有一个

按下Ctrl+Shift+F可以将摄像机移动至当前视角处

**摄像机中的组件：**

- Transform：位置

- Camera：眼睛

- Audio Listener：耳朵

**Camera的属性：**

- Clear Flags：场景空白部分(没物体的部分)的颜色

  - Skybox：天空盒，围绕整个场景的包装器，是一个用于模拟天空的材质(Meterial)
  - Solid Color：纯色
  - Depth only：只显示有物体的地方，其他地方显示为透明

- Culling Mask：能看见的层级

  每个物体都属于一个层级中，如果在Culling Mask中选择不显示某个层级，则这个层级中的物体即使在摄像机视锥范围内也不会显示和渲染

- Projection：投射方式

  - Perspective：正交模式，3D近大远小
  - Orthographic：2D模式

- Filed of View：将视野拉近拉远

- Clipping Planes：只渲染距离摄像机Near到Far范围内的物体

- Viewport Rect：摄像机画面在屏幕中的大小和位置

  可以用来做后视镜或者小地图或者同屏游戏

  屏幕左下角为（0,0）,给定的坐标为摄像机画面左下角点的坐标

- Depth：设置摄像机的深度，值大的会在值小的上方显示

## 3.5 渲染管线

图形数据在GPU上经过运算处理最终输出到屏幕的过程

Draw Call——每帧调用显卡渲染物体的次数。在Game面板--stats--Batches一项中可以看到

CPU：

1. 选定需要渲染的物体（在视锥范围内并且在摄像机的Culling Mask中）
2. 准备数据，调用图形API，将这些物体交给GPU去渲染

GPU：

1. 顶点处理

   接收CPU发来的模型顶点数据，进行坐标系转换

2. 图元装配

   连接相邻的顶点，绘制为三角面

3. 光栅化

   计算三角面上的像素，并为后面着色阶段提供合理的插值参数

4. 像素处理

   对每个像素区域进行着色

5. 缓存

   像素区域着色完毕后，先写入缓存中，等整个画面都着色完毕再一起显示

   缓存是一个存储像素数据的内存块，包括帧缓存和深度缓存

   - 帧缓存：存储每个像素的色彩
   - 深度缓存：存储像素的深度信息，即物体到摄像机的距离，在同一像素点只显示深度值小（距摄像机近）的色彩

## 3.6 FBX模型文件

网格(Mesh) + 材质(Material) + 贴图(Texture) = 模型(Model)

- 网格：定义物体的形状
- 材质：定义表面的光学特性
- 贴图：定义表面的像素颜色

在建模软件中建好的模型应该包括以上三部分，然后导出为FBX格式文件

贴图文件不包含在fbx文件中，是一个单独的文件。使用时放在fbx相同目录或者同级的Textures目录下能够自动识别

# 4. InstantOC插件

## 4.1  即时遮挡剔除功能

**即使遮挡剔除：**

当物体被送进渲染流水线之前，将摄像机视角内看不到的物体进行剔除，从而减少每帧渲染数据量，提高渲染性能

## 4.2 多细节层次LOD功能

LOD(Levels of Detail)技术指根据物体模型在显示环境中所处的位置和重要度，决定物体渲染的资源分配，降低非重要物体的面数和细节都，从而获得高效率的渲染运算

就是离摄像机近使用更精致的模型，离摄像机远的使用更粗略的模型，需要准备Lod_0、Lod_1等不同等级模型来供系统选择，同时确定距离摄像机的距离和要显示的模型

# 5.  光照系统

## 5.1 全局光照GI

全局光照（Global Illumination，简称GI），是一个包括直接光、间接光、环境光以及反射光的光照系统，通过GI算法使渲染出来的光照效果更为真实丰富

### 5.1.1 直接光照：

从光源直接发出的光，通过Light组件实现

在Scene面板选中小太阳表示在Scene面板中显示程序中的具体光源，否则只会统一用一个线性光来代替

**属性：**

- Type：光的形式
  - Directional：平行光，可以用来模拟太阳。光照效果只和光的角度有关，与光的位置无关
  - Point：点光源，向以自身为中心的球形区域发光，模拟灯泡
  - Spot：聚光源，向锥形范围发光，模拟手电筒
- Range：照射范围，只有点光源和聚光有
- Color：光的颜色
- Intensity：光的强度

### 5.1.2 间接光照

物体表面在接收光照后反射(反弹)出来的光

只有标记为Lightmaping Static的物体才能产生间接反弹光照，通过Light组件的Indirect Multiplier可以调节其强度

### 5.1.3 环境光照

作用与场景内所有物体的光照

通过工具栏 -- Window -- Lignting -- settings --  Environment Lignting（或者Ambient）设置

### 5.1.4 反射光照

根据天空盒或立方体贴图计算的作用于所有物体的反射效果

通过工具栏 -- Window -- Lignting -- settings -- Environment Reflections设置

## 5.2 实时GI

实时是指在运行期间任意修改光源，所有的变化可以立即更新

## 5.3 烘焙GI

将光线效果预渲染成贴图，再贴到物体上模拟光影

烘焙GI需要将物体设置为static，之后在Light组件中调节光的mode

## 5.4 光源侦测Light Probes

由于LightMapping只能作用于static物体，就导致运动物体与场景中的光线无法融合在一起

Light Probes组件可以通过Probe收集光影信息，然后将运动物体附近的光影信息做成贴图作用到物体上

使用时需要创建游戏物体Light Probe Groupe

# 6. 声音系统

## 6.1 概述

Unity支持的音频文件格式：mp3，ogg，wav，aif，mod，it，s3m，xm

声音分为两类

- 3D声音：有空间感，近大远小
- 2D声音：适合背景音乐

在场景中产生声音，主要依靠两个组件

- Audio Listener：音频监听器，Camera中自带该组件

  接收场景中音频源Audio Source发出的声音，通过计算机的扬声器播放声音

- Audio Source音频源

## 6.2 Audio Source

在Hierarchy面板中右键创建Audio Source物体，自带Audio Source组件
